metadata:
  apiVersion: v1
  created_at: '2021-08-31T10:23:47.942106'
  last_modified: '2021-08-31T10:23:47.942308'
  name: Resource Policy for my app
organizations:
- metadata:
    description: Some very long text here
    label: default
    name: Default organization
  permissions:
  - label: default.user.read_all
    type: Allow
  - label: default.user.read_basic
    type: Allow
  - label: default.user.read_all_better
    type: Allow
permissions:
- metadata:
    description: Every permission related to Users
    label: user
    name: User permissions
  resources:
  - label: user.read_basic
    name: Allows to read user basic informations
  - label: user.read_all
    name: Allows to read all informations about users
  - label: user.read_all_better
    name: Allows to read all informations about users
  - label: user.update
    name: Allows to edit user
  - label: user.delete
    name: Allows to delete user
  - label: user.all
    name: user.all
  rules:
  - name: Read all gives read basic
    then:
    - user.read_basic
    when: user.read_all
  - name: user.read_all_better
    then:
    - user.read_all
    when: user.read_all_better
  - name: user.all
    then:
    - user.read_basic
    - user.read_all
    - user.read_all_better
    - user.update
    - user.delete
    when: user.all
roles:
- metadata:
    description: Some very long text here
    label: superuser
    name: Admin User
    organization: default
  permissions:
  - label: default.user.read_all
    type: Allow
  - label: default.user.read_basic
    type: Allow
